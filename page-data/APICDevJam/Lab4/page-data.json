{"componentChunkName":"component---src-pages-apic-dev-jam-lab-4-index-md","path":"/APICDevJam/Lab4/","result":{"pageContext":{"frontmatter":{"title":"APIC Dev Jam Lab 4 - Use Lifecycle Controls to Version your API"},"relativePagePath":"/APICDevJam/Lab4/index.md","titleType":"page","MdxNode":{"id":"cbd8a69a-8c36-5042-8c53-8fc12c44e0c0","children":[],"parent":"5da5a838-56a9-5bcc-be80-c8b72a98542f","internal":{"content":"---\r\ntitle: APIC Dev Jam Lab 4 - Use Lifecycle Controls to Version your API\r\n---\r\n\r\nIn the previous lab, you created a new version of the inventory API\r\nwhich is secured with an OAuth 2.0 provider. At this stage, however, the\r\nchanges are still in draft mode. In order for the changes to take\r\neffect, you must publish the APIs to the developer portal and make them\r\navailable for the API Consumers. Recall though that the inventory 1.0.0\r\nversion is already running and has active subscribers.\r\n\r\nAPI lifecycle management capabilities is an essential part of the API\r\nManagement platform. The API lifecycle includes the following stages:\r\n\r\n1.  Plan and design the API.\r\n\r\n2.  Develop the API.\r\n\r\n3.  Test the API.\r\n\r\n4.  Deploy (publish) the API.\r\n\r\n5.  Retire and deprecate the API.\r\n\r\nIn this tutorial, you will explore the following key capabilities:\r\n\r\n-   Creating a new API Product\r\n\r\n-   Replacing the Old Product\r\n\r\n-   Testing Your OAuth API in the Developer Portal\r\n\r\n## APIC Dev Jam Series\r\n\r\nThe APIC Dev Jam Series is a hands-on workshop with lab exercises that\r\nwalk you through designing, publishing, and securing APIs. This workshop\r\nis for API developers, architects, and line of business people who want\r\nto create a successful API strategy. There are 8 labs and each is 30\r\nminutes long. Make sure you choose enough time in your reservation to\r\nget through all the labs! \r\n\r\n\r\n[NOTE: ]**[This demo environment contains a\r\nfull API Connect installation in Cloud Pak for Integration. The login\r\ninformation to the APIC cluster will be sent in a separate email when\r\nyou reserve the instance. Use Google Chrome, Firefox or Microsoft Edge\r\nto access the cluster using the credentials supplied. Make sure you\r\nlogin using API Manager User Registry not Common Services\r\nregistry.]**\r\n\r\nPrerequisites: Labs 1-3\r\n\r\n## Create A New Product\r\n\r\nIn IBM API Connect, Plans and APIs are grouped together in Products,\r\nwith which you can manage the availability and visibility of APIs and\r\nPlans. Products allow related APIs to be bundled together for\r\nsubscribers. In Lab 1, when the inventory microservice application was\r\ngenerated, it also created a default product. In this section, you will\r\ncreate a new product from scratch and stage it to your API Manager\r\nenvironment.\r\n\r\nThe following link provides more information about API Products in IBM\r\nAPI Connect:\r\n\r\n<https://www.ibm.com/support/knowledgecenter/en/SSMNED_v10/com.ibm.apic.toolkit.doc/capim_products.html>\r\n\r\n1.  Go to the **[Develop]** tab in your API\r\n    Connect manager interface.\r\n\r\n2.  Click **[Add]** and\r\n    select **[Product.]**\r\n\r\n3.  Click **[New product]** and then\r\n    click [[Next.]]\r\n\r\n    ![](images/tutorial_html_1b6ee2ef86d15297.png)\r\n\r\n4.  Title this product [[Inventory Products]] and\r\n    click [[Next.]]\r\n\r\n    ![](images/tutorial_html_f9602420f730e70a.png)\r\n\r\n5.  Select the [[inventory\r\n    2.0.0 API]],\r\n    then click **[Next]**.\r\n\r\n    ![](images/tutorial_html_a10fb032a1d8a45e.png)\r\n\r\n6.  Add the **[Default Plan]** to your\r\n    product and then click **[Next.]**\r\n\r\n    ![](images/tutorial_html_17459876887d995d.png)\r\n\r\n7.  Keep the default settings and\r\n    click **[Next.]**\r\n\r\n    ![](images/tutorial_html_72aa7b3247f45fd9.png)\r\n\r\n8.  Your product will be created and associated with the required object\r\n    such as APIs and Plans.\r\n\r\n    ![](images/tutorial_html_8cd7b3b91a70d170.png)\r\n\r\n9.  Click **[Edit Product]**. You may want\r\n    to browse across other sections of the \\*API Product\\* menu such as\r\n    \\*Visibility\\*, \\*Plans\\*, and \\*Categories\\* to explore additional\r\n    API Product management capabilities provided by IBM API Connect.\r\n    Based on the information provided, API Connect will generate a yaml\r\n    definition of your API Product. You can check it by clicking on\r\n    the **[Source]** button at the top.\r\n\r\n    ![](images/tutorial_html_df5c1e994aa7e234.png)\r\n\r\n    ![](images/tutorial_html_52a598812456db52.png)\r\n\r\n \r\n\r\n### Stage the Product to your API Manager environment\r\n\r\nBefore an API Product can be published, you must first stage that\r\nProduct to a Catalog. When a Product is in the staged state, it is not\r\nyet visible to, or subscribable by developers. However, it can be\r\nreviewed by the API Product Manager and Published once it is decided\r\nthat the API Product is ready to be consumed.\r\n\r\nIf you stage a Product to a Catalog, editing and then restaging that\r\nProduct through the Products tab of API Designer or API Manager will\r\naffect changes to the staged version.\r\n\r\n1.  In the API Manager, from the main menu on the left,\r\n    click **[Develop]**.\r\n\r\n2.  Click the **[⋮]** button next to your\r\n    API Product and **[Stage]** it.\r\n\r\n    ![](images/tutorial_html_3d083025950cefa6.png)\r\n\r\n3.  Choose your **[Sandbox]** catalog as a\r\n    target for Staging.\r\n\r\n    **Note:**\r\n\r\n    IBM API Connect allows you to publish products to specific gateways\r\n    associated with the Catalog.\r\n\r\n    ![](images/tutorial_html_d3add46b169ce08a.png)\r\n\r\n## Supersede the Old Product\r\n\r\nIBM API Connect provides capabilities for managing the lifecycle of your\r\nAPI Products. There are various states which an API Product can reside\r\nin, as well as controls around when you can move an API Product from one\r\nstate to another. In this section, you will explore how to replace a\r\nrunning version of an API Product with a new one.\r\n\r\n1. Switch to the **[Manage]** tab of the interface and click on\r\n  your **[Sandbox]** catalog tile.\r\n\r\n  ![](images/tutorial_html_dd28754d9b40b41b.gif)\r\n\r\n2. The **[Products tab]** will list all of\r\n  the API Products that this Catalog is currently managing.\r\n\r\n3. Make sure your newly created API Product **[Inventory Products]** is in\r\n  the **[Staged]** status while the\r\n  old **[Inventory APIs]** product\r\n  is **[Published]** in the Catalog.\r\n\r\n  ![](images/tutorial_html_b69739b268fcf1bf.png)\r\n\r\n4. Click on the menu options for the **[Inventory\r\n  APIs]** product and select\r\n  the **[Supersede]** option.\r\n\r\n  ![](images/tutorial_html_779570cda3681c33.png)\r\n\r\n5. Select the **[Inventory Products]** product, as this is the one\r\n  which will supersede Inventory APIs .\r\n\r\n  ![](images/tutorial_html_4be14720ca4455b0.png)\r\n\r\n6. Click **[Next]** in the bottom.\r\n\r\n7. In order to maintain our consumers' entitlements, we need to migrate\r\n  their plan subscriptions.\r\n\r\n  Both of our Products have plans called**[ Default\r\n  Plan.]** You will now choose to move\r\n  subscribers from the Inventory Product's default plan to the\r\n  Inventory Product's default plan.\r\n\r\n  In the drop-down menu, select Default Plan and then\r\n  click [[Supersede]].\r\n\r\n   ![](images/tutorial_html_6303625db3f1ae01.png)\r\n\r\n8. API Connect will take care of deprecating the old product and\r\n  publishing the new one. As a result, the new **Inventory Products** product\r\n  will be published, while the old one will be automatically deprecated.\r\n\r\n   ![](images/tutorial_html_d7847d64c8d3c2d5.png)\r\n\r\n## Test the OAuth Configuration\r\n\r\nIn this section, you will test the new version of the API to ensure that\r\nOAuth is working properly.\r\n\r\n1.  Open your API Portal in a new browser tab and log in with your\r\n    developer account. \r\n\r\n2.  Click the **[API Products]** tab.\r\n\r\n3.  Notice that the old **[Inventory\r\n    APIs]** product is no longer available.\r\n    It has been replaced by your new **[Inventory Products]** product.\r\n\r\n4.  Click on the **[ Inventory Products]**. \r\n\r\n    **Note:** There is no need\r\n    to re-subscribe your application to the plan. By\r\n    using **[Replace]** as the state change\r\n    control, your subscription was automatically migrated. As a result,\r\n    you're already entitled to the API's contained in the new Product's\r\n    Default Plan - including the O-Auth API.\r\n\r\n    ![](images/tutorial_html_b752e8ed59be706d.png)\r\n\r\n5.  Select Subscribe Default Plan and then select IBM Consumer App to\r\n    subscribe the app.\r\n\r\n6.  Click on the **[inventory API]** from\r\n    the palette menu on the left.\r\n\r\n7.  Select the **[GET /Items]** operation\r\n    and click on the **[Try It ]**button at\r\n    the top. Notice that we now have an additional OAuth security\r\n    requirement defined.    \r\n\r\n    ![](images/tutorial_html_641396f6f65e50e1.png)\r\n\r\n8.  Scroll down to browse the invocation form.\r\n\r\n9.  Select your subscribed application from the **[Client\r\n    ID]** drop-down menu.\r\n\r\n10. Paste your secret into the **[Client\r\n    secret ]**field.\r\n\r\n11. In\r\n    the **[Username]** and **[Password]** fields,\r\n    you can enter any text. Select the inventory scope. **Note:** \r\n    Recall that when we configured the OAuth API, we provided an\r\n    Authentication URL as the method for validating the user\r\n    credentials. The URL that we provided will respond back OK with any\r\n    credentials.\r\n\r\n12. Click the **[Get Token]** button to\r\n    obtain an OAuth token. \r\n\r\n    -   The API Portal will call out to the OAuth Token URL with your\r\n        client credentials and user credentials.\r\n\r\n    -   The OAuth API which you built in lab 3 will intercept the\r\n        request, validate the credentials, and generate a token.  \r\n\r\n    ![](images/tutorial_html_deb6f414f76d453e.png)\r\n\r\n13. Click the **[Send]** button to invoke\r\n    the API. The request will include the OAuth bearer token in\r\n    the **[Authorization]** header.\r\n\r\n    ![](images/tutorial_html_40c0aad7db0f83e7.png)\r\n\r\n<!--14. To prove that the token is being validated, you can either remove or\r\n    modify the contents of the **[Access\r\n    Token]** field. Then click\r\n    the **[Send]** button again and see\r\n    the **401 Unauthorized **error response.-->\r\n\r\n## Summary\r\n\r\nYou completed the APIC Dev Jam Lab 4 - Use Lifecycle Controls to Version\r\nyour API. Throughout the tutorial, you explored the key takeaways:   \r\n\r\n-   Create a new API Product.\r\n\r\n-   Supercede the Old Product.\r\n\r\n-   Test Your OAuth API in the Developer Portal.\r\n\r\nContinue the APIC Dev Jam! Go to[ APIC Dev Jam - Lab 5 - Advanced API\r\nAssembly](../Lab5) to\r\nlearn about adding business logic to the API Gateway through the use of\r\npolicies. \r\n","type":"Mdx","contentDigest":"b13d0479deb66038dc086f1be09c18f2","counter":1561,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"APIC Dev Jam Lab 4 - Use Lifecycle Controls to Version your API"},"exports":{},"rawBody":"---\r\ntitle: APIC Dev Jam Lab 4 - Use Lifecycle Controls to Version your API\r\n---\r\n\r\nIn the previous lab, you created a new version of the inventory API\r\nwhich is secured with an OAuth 2.0 provider. At this stage, however, the\r\nchanges are still in draft mode. In order for the changes to take\r\neffect, you must publish the APIs to the developer portal and make them\r\navailable for the API Consumers. Recall though that the inventory 1.0.0\r\nversion is already running and has active subscribers.\r\n\r\nAPI lifecycle management capabilities is an essential part of the API\r\nManagement platform. The API lifecycle includes the following stages:\r\n\r\n1.  Plan and design the API.\r\n\r\n2.  Develop the API.\r\n\r\n3.  Test the API.\r\n\r\n4.  Deploy (publish) the API.\r\n\r\n5.  Retire and deprecate the API.\r\n\r\nIn this tutorial, you will explore the following key capabilities:\r\n\r\n-   Creating a new API Product\r\n\r\n-   Replacing the Old Product\r\n\r\n-   Testing Your OAuth API in the Developer Portal\r\n\r\n## APIC Dev Jam Series\r\n\r\nThe APIC Dev Jam Series is a hands-on workshop with lab exercises that\r\nwalk you through designing, publishing, and securing APIs. This workshop\r\nis for API developers, architects, and line of business people who want\r\nto create a successful API strategy. There are 8 labs and each is 30\r\nminutes long. Make sure you choose enough time in your reservation to\r\nget through all the labs! \r\n\r\n\r\n[NOTE: ]**[This demo environment contains a\r\nfull API Connect installation in Cloud Pak for Integration. The login\r\ninformation to the APIC cluster will be sent in a separate email when\r\nyou reserve the instance. Use Google Chrome, Firefox or Microsoft Edge\r\nto access the cluster using the credentials supplied. Make sure you\r\nlogin using API Manager User Registry not Common Services\r\nregistry.]**\r\n\r\nPrerequisites: Labs 1-3\r\n\r\n## Create A New Product\r\n\r\nIn IBM API Connect, Plans and APIs are grouped together in Products,\r\nwith which you can manage the availability and visibility of APIs and\r\nPlans. Products allow related APIs to be bundled together for\r\nsubscribers. In Lab 1, when the inventory microservice application was\r\ngenerated, it also created a default product. In this section, you will\r\ncreate a new product from scratch and stage it to your API Manager\r\nenvironment.\r\n\r\nThe following link provides more information about API Products in IBM\r\nAPI Connect:\r\n\r\n<https://www.ibm.com/support/knowledgecenter/en/SSMNED_v10/com.ibm.apic.toolkit.doc/capim_products.html>\r\n\r\n1.  Go to the **[Develop]** tab in your API\r\n    Connect manager interface.\r\n\r\n2.  Click **[Add]** and\r\n    select **[Product.]**\r\n\r\n3.  Click **[New product]** and then\r\n    click [[Next.]]\r\n\r\n    ![](images/tutorial_html_1b6ee2ef86d15297.png)\r\n\r\n4.  Title this product [[Inventory Products]] and\r\n    click [[Next.]]\r\n\r\n    ![](images/tutorial_html_f9602420f730e70a.png)\r\n\r\n5.  Select the [[inventory\r\n    2.0.0 API]],\r\n    then click **[Next]**.\r\n\r\n    ![](images/tutorial_html_a10fb032a1d8a45e.png)\r\n\r\n6.  Add the **[Default Plan]** to your\r\n    product and then click **[Next.]**\r\n\r\n    ![](images/tutorial_html_17459876887d995d.png)\r\n\r\n7.  Keep the default settings and\r\n    click **[Next.]**\r\n\r\n    ![](images/tutorial_html_72aa7b3247f45fd9.png)\r\n\r\n8.  Your product will be created and associated with the required object\r\n    such as APIs and Plans.\r\n\r\n    ![](images/tutorial_html_8cd7b3b91a70d170.png)\r\n\r\n9.  Click **[Edit Product]**. You may want\r\n    to browse across other sections of the \\*API Product\\* menu such as\r\n    \\*Visibility\\*, \\*Plans\\*, and \\*Categories\\* to explore additional\r\n    API Product management capabilities provided by IBM API Connect.\r\n    Based on the information provided, API Connect will generate a yaml\r\n    definition of your API Product. You can check it by clicking on\r\n    the **[Source]** button at the top.\r\n\r\n    ![](images/tutorial_html_df5c1e994aa7e234.png)\r\n\r\n    ![](images/tutorial_html_52a598812456db52.png)\r\n\r\n \r\n\r\n### Stage the Product to your API Manager environment\r\n\r\nBefore an API Product can be published, you must first stage that\r\nProduct to a Catalog. When a Product is in the staged state, it is not\r\nyet visible to, or subscribable by developers. However, it can be\r\nreviewed by the API Product Manager and Published once it is decided\r\nthat the API Product is ready to be consumed.\r\n\r\nIf you stage a Product to a Catalog, editing and then restaging that\r\nProduct through the Products tab of API Designer or API Manager will\r\naffect changes to the staged version.\r\n\r\n1.  In the API Manager, from the main menu on the left,\r\n    click **[Develop]**.\r\n\r\n2.  Click the **[⋮]** button next to your\r\n    API Product and **[Stage]** it.\r\n\r\n    ![](images/tutorial_html_3d083025950cefa6.png)\r\n\r\n3.  Choose your **[Sandbox]** catalog as a\r\n    target for Staging.\r\n\r\n    **Note:**\r\n\r\n    IBM API Connect allows you to publish products to specific gateways\r\n    associated with the Catalog.\r\n\r\n    ![](images/tutorial_html_d3add46b169ce08a.png)\r\n\r\n## Supersede the Old Product\r\n\r\nIBM API Connect provides capabilities for managing the lifecycle of your\r\nAPI Products. There are various states which an API Product can reside\r\nin, as well as controls around when you can move an API Product from one\r\nstate to another. In this section, you will explore how to replace a\r\nrunning version of an API Product with a new one.\r\n\r\n1. Switch to the **[Manage]** tab of the interface and click on\r\n  your **[Sandbox]** catalog tile.\r\n\r\n  ![](images/tutorial_html_dd28754d9b40b41b.gif)\r\n\r\n2. The **[Products tab]** will list all of\r\n  the API Products that this Catalog is currently managing.\r\n\r\n3. Make sure your newly created API Product **[Inventory Products]** is in\r\n  the **[Staged]** status while the\r\n  old **[Inventory APIs]** product\r\n  is **[Published]** in the Catalog.\r\n\r\n  ![](images/tutorial_html_b69739b268fcf1bf.png)\r\n\r\n4. Click on the menu options for the **[Inventory\r\n  APIs]** product and select\r\n  the **[Supersede]** option.\r\n\r\n  ![](images/tutorial_html_779570cda3681c33.png)\r\n\r\n5. Select the **[Inventory Products]** product, as this is the one\r\n  which will supersede Inventory APIs .\r\n\r\n  ![](images/tutorial_html_4be14720ca4455b0.png)\r\n\r\n6. Click **[Next]** in the bottom.\r\n\r\n7. In order to maintain our consumers' entitlements, we need to migrate\r\n  their plan subscriptions.\r\n\r\n  Both of our Products have plans called**[ Default\r\n  Plan.]** You will now choose to move\r\n  subscribers from the Inventory Product's default plan to the\r\n  Inventory Product's default plan.\r\n\r\n  In the drop-down menu, select Default Plan and then\r\n  click [[Supersede]].\r\n\r\n   ![](images/tutorial_html_6303625db3f1ae01.png)\r\n\r\n8. API Connect will take care of deprecating the old product and\r\n  publishing the new one. As a result, the new **Inventory Products** product\r\n  will be published, while the old one will be automatically deprecated.\r\n\r\n   ![](images/tutorial_html_d7847d64c8d3c2d5.png)\r\n\r\n## Test the OAuth Configuration\r\n\r\nIn this section, you will test the new version of the API to ensure that\r\nOAuth is working properly.\r\n\r\n1.  Open your API Portal in a new browser tab and log in with your\r\n    developer account. \r\n\r\n2.  Click the **[API Products]** tab.\r\n\r\n3.  Notice that the old **[Inventory\r\n    APIs]** product is no longer available.\r\n    It has been replaced by your new **[Inventory Products]** product.\r\n\r\n4.  Click on the **[ Inventory Products]**. \r\n\r\n    **Note:** There is no need\r\n    to re-subscribe your application to the plan. By\r\n    using **[Replace]** as the state change\r\n    control, your subscription was automatically migrated. As a result,\r\n    you're already entitled to the API's contained in the new Product's\r\n    Default Plan - including the O-Auth API.\r\n\r\n    ![](images/tutorial_html_b752e8ed59be706d.png)\r\n\r\n5.  Select Subscribe Default Plan and then select IBM Consumer App to\r\n    subscribe the app.\r\n\r\n6.  Click on the **[inventory API]** from\r\n    the palette menu on the left.\r\n\r\n7.  Select the **[GET /Items]** operation\r\n    and click on the **[Try It ]**button at\r\n    the top. Notice that we now have an additional OAuth security\r\n    requirement defined.    \r\n\r\n    ![](images/tutorial_html_641396f6f65e50e1.png)\r\n\r\n8.  Scroll down to browse the invocation form.\r\n\r\n9.  Select your subscribed application from the **[Client\r\n    ID]** drop-down menu.\r\n\r\n10. Paste your secret into the **[Client\r\n    secret ]**field.\r\n\r\n11. In\r\n    the **[Username]** and **[Password]** fields,\r\n    you can enter any text. Select the inventory scope. **Note:** \r\n    Recall that when we configured the OAuth API, we provided an\r\n    Authentication URL as the method for validating the user\r\n    credentials. The URL that we provided will respond back OK with any\r\n    credentials.\r\n\r\n12. Click the **[Get Token]** button to\r\n    obtain an OAuth token. \r\n\r\n    -   The API Portal will call out to the OAuth Token URL with your\r\n        client credentials and user credentials.\r\n\r\n    -   The OAuth API which you built in lab 3 will intercept the\r\n        request, validate the credentials, and generate a token.  \r\n\r\n    ![](images/tutorial_html_deb6f414f76d453e.png)\r\n\r\n13. Click the **[Send]** button to invoke\r\n    the API. The request will include the OAuth bearer token in\r\n    the **[Authorization]** header.\r\n\r\n    ![](images/tutorial_html_40c0aad7db0f83e7.png)\r\n\r\n<!--14. To prove that the token is being validated, you can either remove or\r\n    modify the contents of the **[Access\r\n    Token]** field. Then click\r\n    the **[Send]** button again and see\r\n    the **401 Unauthorized **error response.-->\r\n\r\n## Summary\r\n\r\nYou completed the APIC Dev Jam Lab 4 - Use Lifecycle Controls to Version\r\nyour API. Throughout the tutorial, you explored the key takeaways:   \r\n\r\n-   Create a new API Product.\r\n\r\n-   Supercede the Old Product.\r\n\r\n-   Test Your OAuth API in the Developer Portal.\r\n\r\nContinue the APIC Dev Jam! Go to[ APIC Dev Jam - Lab 5 - Advanced API\r\nAssembly](../Lab5) to\r\nlearn about adding business logic to the API Gateway through the use of\r\npolicies. \r\n","fileAbsolutePath":"C:/Users/ruffa/Documents/GitHub/cp4i-demohub/src/pages/APICDevJam/Lab4/index.md"}}},"staticQueryHashes":["1054721580","1054721580","1364590287","2102389209","2102389209","2456312558","2746626797","2746626797","3018647132","3018647132","3037994772","3037994772","768070550","768070550"]}
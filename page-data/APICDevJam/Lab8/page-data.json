{"componentChunkName":"component---src-pages-apic-dev-jam-lab-8-index-md","path":"/APICDevJam/Lab8/","result":{"pageContext":{"frontmatter":{"title":"APIC Dev Jam - Lab 8 -- Creating GraphQL Proxy API"},"relativePagePath":"/APICDevJam/Lab8/index.md","titleType":"page","MdxNode":{"id":"2251f22c-b152-5da2-a926-568d70c18242","children":[],"parent":"d8d03ae4-c600-54a5-aded-bdb2e18d384f","internal":{"content":"---\ntitle: APIC Dev Jam - Lab 8 -- Creating GraphQL Proxy API\n---\n\nIn this lab, you will explore the how to define GraphQL APIs that proxy\nto a backend GraphQL server. GraphQL is a query language for APIs that\ngives an application client greater control over what data it retrieves\nin an API request when compared with a REST API request.\n\nAPI Connect GraphQL support also allows rate limiting and other controls\nusing API Gateway.\n\nIn this tutorial, you will explore the following key capabilities:\n\n-   Create a GraphQL Proxy API\n\n-   Learn about GraphQL introspection and Schema Editor\n\n-   Test APIs by using the built-in GraphQL editor\n\n-   Review API Assembly Policies for the cost end point\n\n## APIC Dev Jam Series\n\nThe APIC Dev Jam Series is a hands-on workshop with lab exercises that\nwalk you through designing, publishing, and securing APIs. This workshop\nis for API developers, architects, and line of business people who want\nto create a successful API strategy. There are 8 labs and each is 30\nminutes long. Make sure you choose enough time in your reservation to\nget through all the labs! \n\n \n\n[NOTE: ]**[This demo environment contains a\nfull API Connect installation in Cloud Pak for Integration. The login\ninformation to the APIC cluster will be sent in a separate email when\nyou reserve the instance. Use Google Chrome, Firefox or Microsoft Edge\nto access the cluster using the credentials supplied. Make sure you\nlogin using API Manager User Registry not Common Services\nregistry.]**\n\nPrerequisites: None\n\n## Create a GraphQL Proxy API\n\n1.  Select Develop API and click Add-\\>API\n\n    ![](images/tutorial_html_c0c5acec16e566bb.png)\n\n2.  Enter the following values and click Next. You To create a GraphQL\n    proxy definition, select From Existing GraphQL service. When you\n    point to an existing GraphQL server, API Connect introspects the\n    service and automatically creates a GraphQL proxy service.\n\n    ![](images/tutorial_html_797b2f887d77017c.png)\n\n3.  Enter the following values and click Next. You can use default\n    values for the rest.\n\n    Title: accounts\n\n    GraphQL server URL: https://graphql-test-server.us-east.cf.appdomain.cloud/accounts/graphql\n\n    ![](images/tutorial_html_f83e60ae96763438.png)\n\n    ![](images/tutorial_html_90e0cbad29eca5a.png)\n\n4.  The schema validator reports warning and errors if found. There is\n    one warning in the accounts schema imported from the server. You can\n    review the schema warning details and also select the end points\n    interested for this proxy. Select all the available end points.\n\n    ![](images/tutorial_html_3cc23a786c4f73c2.png)\n\n5.  A review of the schema shows that no limit is set on the size of the\n    list. You will fix this warning in later steps. Click Next to\n    continue.\n\n    ![](images/tutorial_html_8104c10fce21e609.png)\n\n6.  Keep both Secure Client ID and CORS checked and click Next\n\n    ![](images/tutorial_html_464f81f24c7d47dd.png)\n\n7.  API Connect successfully created a GraphQL proxy API. You can edit\n    the API to view more details on the proxy API just created. Click\n    EDIT API to continue.\n\n    ![](images/tutorial_html_e70bb58508f9b662.png)\n\n8.  GraphQL APIs are structured the same as REST APIs with some\n    additional options. Just like REST APIs, you will be able to add\n    security definitions, properties and Activity logs from the left\n    menu bar. You can also view the Source and Assemble tabs similar to\n    REST APIs. You will notice a new tab for GraphQL APIs. Click on\n    GraphQL Schema tab to view the schema.\n\n    ![](images/tutorial_html_b27d147e1a49276b.png)\n\n9.  GraphQL Schema editor displays Type and Weight information. The\n    weighting factor is used when calculating the type cost for a\n    request to the GraphQL API. For example, a field that requires\n    extensive CPU or memory use on the server to retrieve its value\n    would be given a higher cost.\n\n    ![](images/tutorial_html_ab0c11b157a7cd4b.png)\n\n10. Select Query to review the warning details for this type. In\n    addition to the warning details, the Warning window gives an option\n    to fix the warning by apply the limits. Click Apply to continue.\n\n    ![](images/tutorial_html_ed0f88002c9eb816.png)\n\n11. After applyting the recommendation the wanrning message is removed.\n    Click Save to save the API definition .\n\n    ![](images/tutorial_html_63ce76efdb0032d7.png)\n\n12. Select Assemble to view the API in Assembly view. The flow is\n    automatically created as part of the initial API creation. You may\n    apply addition logic by dragging and dropping items from the pallet\n    to the canvas. In this tutorial, you are not adding additional\n    logic.\n\n    ![](images/tutorial_html_a2cd4daada4f2ca5.png)\n\n13. To publish the API toggle the button from offline to online.\n\n    ![](images/tutorial_html_965b91d211caf432.png)\n\n14. After successfully publishing the API to API Gateway, additional\n    tabs appear on the screen. Select Test tab to test the API.\n\n    ![](images/tutorial_html_ccb982e24326f44f.png)\n\n15. To test the API select the end point by append graphql at the end of\n    the request URL for GET method. The URL should look like this (your\n    value may be different):\n\n    <https://apic-dev-gw-gateway-apic.cp4inew-138661-3195e5b101a2fc76b9c4875fb79cfa25-0000.us-south.containers.appdomain.cloud/org01/sandbox/accounts/graphql>\n\n    Click **Send** to test the API.\n\n    An empty string is returned since we have not specified query string yet.\n\n16. API Connect Test feature also includes GraphQL Editor. Enter the\n    following in in GraphQL Editor window. You may use Prettify option\n    to view formatting string.\n\n```\n{\n  accounts(limit: 2) {\n    name {\n      first\n      last\n    }\n  }\n}\n```\n\n17. Click Run button to send the GraphQL request to the end point. An\n    exception window will appear when you use test the API for the first\n    time.\n\n\n18. Click accept Exception to continue.\n\n    ![](images/tutorial_html_98d8f253e9342c8b.png)\n\n    You may see an invalid certificate issue page when you continue. This is\n    because valid certificates are not applied in this test environment. If\n    you are using Chrome browser you can accept the exception by typing\n    \"thisisunsafe\" anywhere in the window. Similar workarounds are available\n    for other browsers. For firefox browser, follow the steps from here -\n    <https://support.mozilla.org/en-US/kb/error-codes-secure-websites>\n\n    ![](images/tutorial_html_ac0c773416db4db7.png)\n\n19. The results for GraphQL request are displayed on the right panel. In\n    the request we limited the values to 2, so only two accounts are\n    displayed. Change the value to 5 and submit the request again and\n    notice that more accounts are returned in the results window.\n\n    ![](images/tutorial_html_1d05935575c71f8e.png)\n\n20. You can request additional data fields (refer to the schema editor\n    for details), GraphQL may reject if certain fields are locked or\n    prohibited. To test this, enter CreditCard information in the\n    request field.\n\n    The complete request looks as follows:\n```\n{\n  accounts(limit: 2) {\n    name {\n      first\n      last\n    }\n    shippingAddress {\n      building\n      street\n    }\n  }\n  creditCard {\n    number\n    expirationDate\n  }\n}\n```\n\n  You will notice that an error message is displayed in the results window\n  instead of the account values as the server restricts the query field\n  creditCard.\n\n  (Note: The error message displayed may be different than what is shown\n    in the screenshot).\n\n  ![](images/tutorial_html_81c927163c9c11bb.png)\n\n21. Submit another request to get account and shipping address details.\n    This time the values are turned without errors.\n\n    ![](images/tutorial_html_e37331678c3d02b2.png)\n\n## Create a Product and apply GraphQL RateLimits\n\n1.  To create a product Select Develop icon from left menu bar and click\n    Add-\\>Product\n\n    ![](images/tutorial_html_4f43bda35452bd65.png)\n\n2.  Name the product as Accounts Product and click Next\n\n    ![](images/tutorial_html_d0c3992a4bd7bc24.png)\n\n3.  Add Accounts API to the product by selecting accounts. Click Next to\n    continue to create the accounts-product.\n\n    ![](images/tutorial_html_4ae09f5fddd82bab.png)\n\n4.  Edit the product accounts-product to review the details. The Default\n    Plan contains traditional rate limiting options but you will notice\n    another section that list GraphQL Rate Limits.\n\n    ![](images/tutorial_html_15d9c2582155eea8.png)\n\n5.  You will be able to adjust GraphQL cost parameters from this\n    section. You can set a limit or make it unlimited. You will not be\n    making any changes in this tutorial.\n\n    ![](images/tutorial_html_3c25f5d5dab1988e.png)\n\n6.  Publish the Product to Sandbox Catalog by selecting Publish\n\n    ![](images/tutorial_html_a1f1cf7707e31913.png)\n\n7.  Accept the default for Visibility and Subscribability\n\n    ![](images/tutorial_html_1adf1922464ea393.png)\n\n8.  Click Publish to complete publishing the product.\n\n    ![](images/tutorial_html_890ebcd8219b104.png)\n\n## Test GraphQL API from Developer Portal\n\n1.  Sign in to API Connect Developer Portal using the Developer Portal\n    URL, username and password provided by the instructor.\n\n    ![](images/tutorial_html_540cbe0b9202f4a7.png)\n\n    ![](images/tutorial_html_c34973eb377015ce.png)\n\n2.  Developer Portal displays all the products that are currently\n    published. Locate accounts-product and select the product.\n\n    ![](images/tutorial_html_2635d049f12d59c6.png)\n\n3.  The selected product lists one API (accounts api) and one Plan\n    (Default Plan). Select Subscribe option to subscribe to the plan.\n\n    ![](images/tutorial_html_bd0ea34d4f40d756.png)\n\n4.  The Plan subscription requires an Application. You can create a new\n    Application or select the IBM Consumer application that is already\n    created.\n\n    ![](images/tutorial_html_2fd3cf48168675e5.png)\n\n5.  Select accounts API to review and test the API. Click accounts to\n    continue\n\n    ![](images/tutorial_html_8a5975dd9780a924.png)\n\n6.  Developer Portal displays the type as GrahQL API. Currently Client\n    ID security is enforced. Since there is only on Plan and one\n    Consumer Application, the Consumer ID filed is already populated.\n\n    ![](images/tutorial_html_e8892b4b3da410fc.png)\n\n7.  To continue to test the API, use the GraphQL Editor. Submit requests\n    with different field names and watch how quickly the results are\n    returned in the results window. If this was a REST API multiple end\n    points will be needed to achieve the same result.\n\n    ![](images/tutorial_html_9575e27d8184b8fc.png)\n\n## Summary\n\nCongratulations! You have successfully created a GraphQL Proxy API,\npublished the API as part of a Product, applied controls and rate\nlimits, and tested using Developer Portal.\n\nTo learn more about Cloud Pak for Integration and API Life Cycle\nManagement, visit <https://www.ibm.com/cloud/cloud-pak-for-integration>\n","type":"Mdx","contentDigest":"d8304a5bfe94502d1ccf1604be29ea7a","counter":1643,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"APIC Dev Jam - Lab 8 -- Creating GraphQL Proxy API"},"exports":{},"rawBody":"---\ntitle: APIC Dev Jam - Lab 8 -- Creating GraphQL Proxy API\n---\n\nIn this lab, you will explore the how to define GraphQL APIs that proxy\nto a backend GraphQL server. GraphQL is a query language for APIs that\ngives an application client greater control over what data it retrieves\nin an API request when compared with a REST API request.\n\nAPI Connect GraphQL support also allows rate limiting and other controls\nusing API Gateway.\n\nIn this tutorial, you will explore the following key capabilities:\n\n-   Create a GraphQL Proxy API\n\n-   Learn about GraphQL introspection and Schema Editor\n\n-   Test APIs by using the built-in GraphQL editor\n\n-   Review API Assembly Policies for the cost end point\n\n## APIC Dev Jam Series\n\nThe APIC Dev Jam Series is a hands-on workshop with lab exercises that\nwalk you through designing, publishing, and securing APIs. This workshop\nis for API developers, architects, and line of business people who want\nto create a successful API strategy. There are 8 labs and each is 30\nminutes long. Make sure you choose enough time in your reservation to\nget through all the labs! \n\n \n\n[NOTE: ]**[This demo environment contains a\nfull API Connect installation in Cloud Pak for Integration. The login\ninformation to the APIC cluster will be sent in a separate email when\nyou reserve the instance. Use Google Chrome, Firefox or Microsoft Edge\nto access the cluster using the credentials supplied. Make sure you\nlogin using API Manager User Registry not Common Services\nregistry.]**\n\nPrerequisites: None\n\n## Create a GraphQL Proxy API\n\n1.  Select Develop API and click Add-\\>API\n\n    ![](images/tutorial_html_c0c5acec16e566bb.png)\n\n2.  Enter the following values and click Next. You To create a GraphQL\n    proxy definition, select From Existing GraphQL service. When you\n    point to an existing GraphQL server, API Connect introspects the\n    service and automatically creates a GraphQL proxy service.\n\n    ![](images/tutorial_html_797b2f887d77017c.png)\n\n3.  Enter the following values and click Next. You can use default\n    values for the rest.\n\n    Title: accounts\n\n    GraphQL server URL: https://graphql-test-server.us-east.cf.appdomain.cloud/accounts/graphql\n\n    ![](images/tutorial_html_f83e60ae96763438.png)\n\n    ![](images/tutorial_html_90e0cbad29eca5a.png)\n\n4.  The schema validator reports warning and errors if found. There is\n    one warning in the accounts schema imported from the server. You can\n    review the schema warning details and also select the end points\n    interested for this proxy. Select all the available end points.\n\n    ![](images/tutorial_html_3cc23a786c4f73c2.png)\n\n5.  A review of the schema shows that no limit is set on the size of the\n    list. You will fix this warning in later steps. Click Next to\n    continue.\n\n    ![](images/tutorial_html_8104c10fce21e609.png)\n\n6.  Keep both Secure Client ID and CORS checked and click Next\n\n    ![](images/tutorial_html_464f81f24c7d47dd.png)\n\n7.  API Connect successfully created a GraphQL proxy API. You can edit\n    the API to view more details on the proxy API just created. Click\n    EDIT API to continue.\n\n    ![](images/tutorial_html_e70bb58508f9b662.png)\n\n8.  GraphQL APIs are structured the same as REST APIs with some\n    additional options. Just like REST APIs, you will be able to add\n    security definitions, properties and Activity logs from the left\n    menu bar. You can also view the Source and Assemble tabs similar to\n    REST APIs. You will notice a new tab for GraphQL APIs. Click on\n    GraphQL Schema tab to view the schema.\n\n    ![](images/tutorial_html_b27d147e1a49276b.png)\n\n9.  GraphQL Schema editor displays Type and Weight information. The\n    weighting factor is used when calculating the type cost for a\n    request to the GraphQL API. For example, a field that requires\n    extensive CPU or memory use on the server to retrieve its value\n    would be given a higher cost.\n\n    ![](images/tutorial_html_ab0c11b157a7cd4b.png)\n\n10. Select Query to review the warning details for this type. In\n    addition to the warning details, the Warning window gives an option\n    to fix the warning by apply the limits. Click Apply to continue.\n\n    ![](images/tutorial_html_ed0f88002c9eb816.png)\n\n11. After applyting the recommendation the wanrning message is removed.\n    Click Save to save the API definition .\n\n    ![](images/tutorial_html_63ce76efdb0032d7.png)\n\n12. Select Assemble to view the API in Assembly view. The flow is\n    automatically created as part of the initial API creation. You may\n    apply addition logic by dragging and dropping items from the pallet\n    to the canvas. In this tutorial, you are not adding additional\n    logic.\n\n    ![](images/tutorial_html_a2cd4daada4f2ca5.png)\n\n13. To publish the API toggle the button from offline to online.\n\n    ![](images/tutorial_html_965b91d211caf432.png)\n\n14. After successfully publishing the API to API Gateway, additional\n    tabs appear on the screen. Select Test tab to test the API.\n\n    ![](images/tutorial_html_ccb982e24326f44f.png)\n\n15. To test the API select the end point by append graphql at the end of\n    the request URL for GET method. The URL should look like this (your\n    value may be different):\n\n    <https://apic-dev-gw-gateway-apic.cp4inew-138661-3195e5b101a2fc76b9c4875fb79cfa25-0000.us-south.containers.appdomain.cloud/org01/sandbox/accounts/graphql>\n\n    Click **Send** to test the API.\n\n    An empty string is returned since we have not specified query string yet.\n\n16. API Connect Test feature also includes GraphQL Editor. Enter the\n    following in in GraphQL Editor window. You may use Prettify option\n    to view formatting string.\n\n```\n{\n  accounts(limit: 2) {\n    name {\n      first\n      last\n    }\n  }\n}\n```\n\n17. Click Run button to send the GraphQL request to the end point. An\n    exception window will appear when you use test the API for the first\n    time.\n\n\n18. Click accept Exception to continue.\n\n    ![](images/tutorial_html_98d8f253e9342c8b.png)\n\n    You may see an invalid certificate issue page when you continue. This is\n    because valid certificates are not applied in this test environment. If\n    you are using Chrome browser you can accept the exception by typing\n    \"thisisunsafe\" anywhere in the window. Similar workarounds are available\n    for other browsers. For firefox browser, follow the steps from here -\n    <https://support.mozilla.org/en-US/kb/error-codes-secure-websites>\n\n    ![](images/tutorial_html_ac0c773416db4db7.png)\n\n19. The results for GraphQL request are displayed on the right panel. In\n    the request we limited the values to 2, so only two accounts are\n    displayed. Change the value to 5 and submit the request again and\n    notice that more accounts are returned in the results window.\n\n    ![](images/tutorial_html_1d05935575c71f8e.png)\n\n20. You can request additional data fields (refer to the schema editor\n    for details), GraphQL may reject if certain fields are locked or\n    prohibited. To test this, enter CreditCard information in the\n    request field.\n\n    The complete request looks as follows:\n```\n{\n  accounts(limit: 2) {\n    name {\n      first\n      last\n    }\n    shippingAddress {\n      building\n      street\n    }\n  }\n  creditCard {\n    number\n    expirationDate\n  }\n}\n```\n\n  You will notice that an error message is displayed in the results window\n  instead of the account values as the server restricts the query field\n  creditCard.\n\n  (Note: The error message displayed may be different than what is shown\n    in the screenshot).\n\n  ![](images/tutorial_html_81c927163c9c11bb.png)\n\n21. Submit another request to get account and shipping address details.\n    This time the values are turned without errors.\n\n    ![](images/tutorial_html_e37331678c3d02b2.png)\n\n## Create a Product and apply GraphQL RateLimits\n\n1.  To create a product Select Develop icon from left menu bar and click\n    Add-\\>Product\n\n    ![](images/tutorial_html_4f43bda35452bd65.png)\n\n2.  Name the product as Accounts Product and click Next\n\n    ![](images/tutorial_html_d0c3992a4bd7bc24.png)\n\n3.  Add Accounts API to the product by selecting accounts. Click Next to\n    continue to create the accounts-product.\n\n    ![](images/tutorial_html_4ae09f5fddd82bab.png)\n\n4.  Edit the product accounts-product to review the details. The Default\n    Plan contains traditional rate limiting options but you will notice\n    another section that list GraphQL Rate Limits.\n\n    ![](images/tutorial_html_15d9c2582155eea8.png)\n\n5.  You will be able to adjust GraphQL cost parameters from this\n    section. You can set a limit or make it unlimited. You will not be\n    making any changes in this tutorial.\n\n    ![](images/tutorial_html_3c25f5d5dab1988e.png)\n\n6.  Publish the Product to Sandbox Catalog by selecting Publish\n\n    ![](images/tutorial_html_a1f1cf7707e31913.png)\n\n7.  Accept the default for Visibility and Subscribability\n\n    ![](images/tutorial_html_1adf1922464ea393.png)\n\n8.  Click Publish to complete publishing the product.\n\n    ![](images/tutorial_html_890ebcd8219b104.png)\n\n## Test GraphQL API from Developer Portal\n\n1.  Sign in to API Connect Developer Portal using the Developer Portal\n    URL, username and password provided by the instructor.\n\n    ![](images/tutorial_html_540cbe0b9202f4a7.png)\n\n    ![](images/tutorial_html_c34973eb377015ce.png)\n\n2.  Developer Portal displays all the products that are currently\n    published. Locate accounts-product and select the product.\n\n    ![](images/tutorial_html_2635d049f12d59c6.png)\n\n3.  The selected product lists one API (accounts api) and one Plan\n    (Default Plan). Select Subscribe option to subscribe to the plan.\n\n    ![](images/tutorial_html_bd0ea34d4f40d756.png)\n\n4.  The Plan subscription requires an Application. You can create a new\n    Application or select the IBM Consumer application that is already\n    created.\n\n    ![](images/tutorial_html_2fd3cf48168675e5.png)\n\n5.  Select accounts API to review and test the API. Click accounts to\n    continue\n\n    ![](images/tutorial_html_8a5975dd9780a924.png)\n\n6.  Developer Portal displays the type as GrahQL API. Currently Client\n    ID security is enforced. Since there is only on Plan and one\n    Consumer Application, the Consumer ID filed is already populated.\n\n    ![](images/tutorial_html_e8892b4b3da410fc.png)\n\n7.  To continue to test the API, use the GraphQL Editor. Submit requests\n    with different field names and watch how quickly the results are\n    returned in the results window. If this was a REST API multiple end\n    points will be needed to achieve the same result.\n\n    ![](images/tutorial_html_9575e27d8184b8fc.png)\n\n## Summary\n\nCongratulations! You have successfully created a GraphQL Proxy API,\npublished the API as part of a Product, applied controls and rate\nlimits, and tested using Developer Portal.\n\nTo learn more about Cloud Pak for Integration and API Life Cycle\nManagement, visit <https://www.ibm.com/cloud/cloud-pak-for-integration>\n","fileAbsolutePath":"/Users/rafaelosorio/Documents/GitHub/cp4i-demohub/src/pages/APICDevJam/Lab8/index.md"}}},"staticQueryHashes":["1054721580","1054721580","1364590287","2102389209","2102389209","2456312558","2746626797","2746626797","3018647132","3018647132","3037994772","3037994772","768070550"]}
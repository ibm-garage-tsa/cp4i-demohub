{"componentChunkName":"component---src-pages-apic-dev-jam-lab-3-index-md","path":"/APICDevJam/Lab3/","result":{"pageContext":{"frontmatter":{"title":"APIC Dev Jam Lab 3 - Add OAuth Security to your API"},"relativePagePath":"/APICDevJam/Lab3/index.md","titleType":"page","MdxNode":{"id":"5cc1a350-5258-585b-98ad-3177561106c8","children":[],"parent":"e810ccf3-6e16-5ffc-bb8a-6464888580fc","internal":{"content":"---\r\ntitle: APIC Dev Jam Lab 3 - Add OAuth Security to your API\r\n---\r\n\r\nIn this lab, you will secure the Inventory API to protect the resources\r\nexposed by **API Connect**. Consumers of your API will be required to\r\nobtain and provide a valid OAuth token before they can invoke the\r\nInventory API.\r\n\r\nIn this tutorial, you will explore the following key capabilities:\r\n\r\n-   Configure an OAuth 2.0 service, the Resource Owner Password grant\r\n    type.\r\n\r\n-   Clone a new version of an API.\r\n\r\n-   Secure the new version of your API.\r\n\r\n## APIC Dev Jam Series\r\n\r\nThe APIC Dev Jam Series is a hands-on workshop with lab exercises that\r\nwalk you through designing, publishing, and securing APIs. This workshop\r\nis for API developers, architects, and line of business people who want\r\nto create a successful API strategy. There are 8 labs and each is 30\r\nminutes long. Make sure you choose enough time in your reservation to\r\nget through all the labs! \r\n\r\n[NOTE: ]**[This demo environment contains a\r\nfull API Connect installation in Cloud Pak for Integration. The login\r\ninformation to the APIC cluster will be sent in a separate email when\r\nyou reserve the instance. Use Google Chrome, Firefox or Microsoft Edge\r\nto access the cluster using the credentials supplied. Make sure you\r\nlogin using API Manager User Registry not Common Services\r\nregistry.]**\r\n\r\nPrerequisites: Labs 1-2\r\n\r\n## Configure a New OAuth 2.0 Provider API\r\n\r\nAPI Connect is a full-featured OAuth 2.0 provider. The OAuth exchange\r\nworks like any other API call, and thus we treat it as its own API. In\r\nthis section, you will create a new OAuth provider API, configure which\r\ngrant type to use, and configure how it will authenticate user\r\ncredentials.\r\n\r\n### Configure Authentication URL User Registry\r\n\r\nIn order to configure user authentication, you must first define the\r\nregistry to use, which may be LDAP, local user registry, or an\r\nauthentication URL. For our lab, we will implement an Authentication\r\nURL.\r\n\r\n1.  In the API Manager from the main menu on the left,\r\n    click [[Resources]].\r\n\r\n    ![](images/tutorial_html_newcreateregistry.png)\r\n\r\n2.  Select the [[Authentication URL User\r\n    Registry]] tile.\r\n\r\n    ![](images/tutorial_html_ae58ee320d642047.png)\r\n\r\n3.  Specify the only following properties and then\r\n    click [[Save.]]\r\n\r\n    Title: [[App Registry]]\r\n\r\n    URL: <https://thinkibm-services.mybluemix.net/auth>\r\n\r\n    Display name:[[ App Registry]]\r\n\r\n    Click **Save** to save the resource\r\n\r\n    ![](images/tutorial_html_ae75a185a7c7e950.png)\r\n\r\n Create OAuth Service\r\n----------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n1.  In the API Manager from the main menu on the left,\r\n    click [[Resources]].\r\n\r\n2.  In the Resources menu, click  [[OAuth Providers-\\> Native OAuth\r\n    Provider]].\r\n\r\n    ![](images/tutorial_html_f1fe85d169c1b8fc.png)\r\n\r\n3.  Specify the following properties and\r\n    click **[Next]** to continue.\r\n\r\n    Title: [[oauth]]\r\n\r\n    Name: [[oauth]]\r\n\r\n    Gateway Type: [[DataPower API Gateway]]\r\n\r\n    ![](images/tutorial_html_22f9d0d5c30f657d.png)\r\n\r\n4.  The next configuration screen will display the default paths to the\r\n    Authorize and Token functions. For Supported grant types,\r\n    choose [[Resource owner\r\n    password]].\r\n    For Supported Client types,\r\n    choose [[Confidential]].\r\n    Click [[Next]] continue.\r\n\r\n    ![](images/tutorial_html_2e278c6df90a639f.png)\r\n\r\n5.  One scope is generated for you\r\n    : [**[sample_scope_1]**[.]]\r\n\r\n6.  Modify the values\r\n    for **[sample_scope_1]**, set the\r\n    following fields:\r\n\r\n    Name: [[inventory]]\r\n\r\n    Description: [[Access to Inventory API]]\r\n\r\n    ![](images/tutorial_html_b42ee8bacaf23a4c.png)\r\n\r\n7.  Click [[Next]].\r\n\r\n8.  Keep all items default.\r\n    Click [[Next.]]\r\n\r\n    ![](images/tutorial_html_985e9dbc3a3f82c0.png)\r\n\r\n9.  Review your OAuth configuration and\r\n    click [[Finish]].\r\n    Then click on the back arrow.\r\n\r\n10. From the Sandbox Catalog registry setting, select API User\r\n    Registries and Add App Registry. To open Sandbox Settings follow\r\n    Home-\\>Manage Catalogs-\\>Sandbox-\\>Settings(Gearbox)->API User Registries.\r\n\r\n    Use **Edit** option and enable available API registry.\r\n\r\n    ![](images/tutorial_html_c24f06de482a8ab5.png)\r\n\r\n Add the OAuth Service to the Sandbox Catalog\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n1.  From the left menu, click [[Home Button\r\n    Icon]].\r\n\r\n2.  Click the [[Manage\r\n    Catalog]] catalog\r\n    and select\r\n    [[Sandbox]] \r\n\r\n3.  From the left menu,\r\n    click [[Settings]]\r\n    gearbox.\r\n\r\n4.  On the displayed menu, click [[OAuth\r\n    Providers]].\r\n\r\n5.  Click [[Edit]].\r\n\r\n6.  Choose the OAuth service created above. Then\r\n    click [[Save]].\r\n    Click on the back arrow to go back to Manage.\r\n\r\n    ![](images/tutorial_html_6fa9961893476e8e.png)\r\n\r\n## Create a New Version of the Inventory API\r\n\r\nAPI Connect supports multiple versions of APIs. Create a new version of\r\nthe inventory API before making any changes that would break\r\nfunctionality for existing consumers. \r\n\r\n### [Save as a New Version]\r\n\r\n1.  In the API Manager from the main menu on the left,\r\n    click [[Develop]].\r\n\r\n2.  Click on the menu icon to the right of [[inventory\r\n    1.0.0]] API\r\n    and select [[Save as a new\r\n    version]].  \r\n\r\n    ![](images/tutorial_html_4f0d083547b597a4.png)\r\n\r\n3.  Enter the new version number\r\n    as [[2.0.0]] and\r\n    click [[Submit]].\r\n\r\n## Add OAuth security to the Inventory API\r\n\r\nModify the security policy for your new API version to tell it to use\r\nyour OAuth 2.0 provider.\r\n\r\n1.  From the Develop home page, click \\`**Inventory 2.0.0**\\`\r\n\r\n2.  Navigate to the **[Security\r\n    Definitions]** section.\r\n\r\n3.  Click [[Add]].\r\n\r\n4.  On the API Security Definition screen, enter the following:\r\n\r\n    -   Name: **[oauth-1]**\r\n\r\n    -   Description: [[API OAuth security\r\n        definition]]\r\n\r\n    -   Type: [[OAuth2]]\r\n\r\n    -   Flow: [[Resource owner]]\r\n\r\n    -   Token URL: keep\r\n        default [[https://\\$(catalog.url)/oauth/oauth2/token]]\r\n\r\n    -   Leave everything else to the default values and\r\n        click **Save**.  \r\n\r\n        ![](images/tutorial_html_9b9f57dc81561ae7.png)\r\n\r\n5.  Navigate to the \\`Security\\` section and check the \\`**oauth-1\r\n    (OAuth)**\\` checkbox. Make sure \\`inventory\\` is also checked.  \r\n\r\n    ![](images/tutorial_html_c8a8e86664fd2a1.png)\r\n\r\n6.  Save your changes.\r\n\r\n## Summary\r\n\r\nYou completed the APIC Dev Jam Lab 3 - Add OAuth Security to your\r\nAPI. Throughout the tutorial, you explored the key takeaways:\r\n\r\n-   Configure an OAuth 2.0 service, the Resource Owner Password grant\r\n    type.\r\n\r\n-   Clone a new version of an API.\r\n\r\n-   Secure the new version of your API.\r\n\r\nContinue the APIC Dev Jam! Go To [APIC (v10) Dev Jam Lab 4 - Use\r\nLifecycle controls to version your\r\nAPI](../Lab4) to\r\nmanage the lifecycle of this API and test your new OAuth secured API.\r\n","type":"Mdx","contentDigest":"05120a7f64c66366d739d4f0f17f755b","counter":1559,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"APIC Dev Jam Lab 3 - Add OAuth Security to your API"},"exports":{},"rawBody":"---\r\ntitle: APIC Dev Jam Lab 3 - Add OAuth Security to your API\r\n---\r\n\r\nIn this lab, you will secure the Inventory API to protect the resources\r\nexposed by **API Connect**. Consumers of your API will be required to\r\nobtain and provide a valid OAuth token before they can invoke the\r\nInventory API.\r\n\r\nIn this tutorial, you will explore the following key capabilities:\r\n\r\n-   Configure an OAuth 2.0 service, the Resource Owner Password grant\r\n    type.\r\n\r\n-   Clone a new version of an API.\r\n\r\n-   Secure the new version of your API.\r\n\r\n## APIC Dev Jam Series\r\n\r\nThe APIC Dev Jam Series is a hands-on workshop with lab exercises that\r\nwalk you through designing, publishing, and securing APIs. This workshop\r\nis for API developers, architects, and line of business people who want\r\nto create a successful API strategy. There are 8 labs and each is 30\r\nminutes long. Make sure you choose enough time in your reservation to\r\nget through all the labs! \r\n\r\n[NOTE: ]**[This demo environment contains a\r\nfull API Connect installation in Cloud Pak for Integration. The login\r\ninformation to the APIC cluster will be sent in a separate email when\r\nyou reserve the instance. Use Google Chrome, Firefox or Microsoft Edge\r\nto access the cluster using the credentials supplied. Make sure you\r\nlogin using API Manager User Registry not Common Services\r\nregistry.]**\r\n\r\nPrerequisites: Labs 1-2\r\n\r\n## Configure a New OAuth 2.0 Provider API\r\n\r\nAPI Connect is a full-featured OAuth 2.0 provider. The OAuth exchange\r\nworks like any other API call, and thus we treat it as its own API. In\r\nthis section, you will create a new OAuth provider API, configure which\r\ngrant type to use, and configure how it will authenticate user\r\ncredentials.\r\n\r\n### Configure Authentication URL User Registry\r\n\r\nIn order to configure user authentication, you must first define the\r\nregistry to use, which may be LDAP, local user registry, or an\r\nauthentication URL. For our lab, we will implement an Authentication\r\nURL.\r\n\r\n1.  In the API Manager from the main menu on the left,\r\n    click [[Resources]].\r\n\r\n    ![](images/tutorial_html_newcreateregistry.png)\r\n\r\n2.  Select the [[Authentication URL User\r\n    Registry]] tile.\r\n\r\n    ![](images/tutorial_html_ae58ee320d642047.png)\r\n\r\n3.  Specify the only following properties and then\r\n    click [[Save.]]\r\n\r\n    Title: [[App Registry]]\r\n\r\n    URL: <https://thinkibm-services.mybluemix.net/auth>\r\n\r\n    Display name:[[ App Registry]]\r\n\r\n    Click **Save** to save the resource\r\n\r\n    ![](images/tutorial_html_ae75a185a7c7e950.png)\r\n\r\n Create OAuth Service\r\n----------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n1.  In the API Manager from the main menu on the left,\r\n    click [[Resources]].\r\n\r\n2.  In the Resources menu, click  [[OAuth Providers-\\> Native OAuth\r\n    Provider]].\r\n\r\n    ![](images/tutorial_html_f1fe85d169c1b8fc.png)\r\n\r\n3.  Specify the following properties and\r\n    click **[Next]** to continue.\r\n\r\n    Title: [[oauth]]\r\n\r\n    Name: [[oauth]]\r\n\r\n    Gateway Type: [[DataPower API Gateway]]\r\n\r\n    ![](images/tutorial_html_22f9d0d5c30f657d.png)\r\n\r\n4.  The next configuration screen will display the default paths to the\r\n    Authorize and Token functions. For Supported grant types,\r\n    choose [[Resource owner\r\n    password]].\r\n    For Supported Client types,\r\n    choose [[Confidential]].\r\n    Click [[Next]] continue.\r\n\r\n    ![](images/tutorial_html_2e278c6df90a639f.png)\r\n\r\n5.  One scope is generated for you\r\n    : [**[sample_scope_1]**[.]]\r\n\r\n6.  Modify the values\r\n    for **[sample_scope_1]**, set the\r\n    following fields:\r\n\r\n    Name: [[inventory]]\r\n\r\n    Description: [[Access to Inventory API]]\r\n\r\n    ![](images/tutorial_html_b42ee8bacaf23a4c.png)\r\n\r\n7.  Click [[Next]].\r\n\r\n8.  Keep all items default.\r\n    Click [[Next.]]\r\n\r\n    ![](images/tutorial_html_985e9dbc3a3f82c0.png)\r\n\r\n9.  Review your OAuth configuration and\r\n    click [[Finish]].\r\n    Then click on the back arrow.\r\n\r\n10. From the Sandbox Catalog registry setting, select API User\r\n    Registries and Add App Registry. To open Sandbox Settings follow\r\n    Home-\\>Manage Catalogs-\\>Sandbox-\\>Settings(Gearbox)->API User Registries.\r\n\r\n    Use **Edit** option and enable available API registry.\r\n\r\n    ![](images/tutorial_html_c24f06de482a8ab5.png)\r\n\r\n Add the OAuth Service to the Sandbox Catalog\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n1.  From the left menu, click [[Home Button\r\n    Icon]].\r\n\r\n2.  Click the [[Manage\r\n    Catalog]] catalog\r\n    and select\r\n    [[Sandbox]] \r\n\r\n3.  From the left menu,\r\n    click [[Settings]]\r\n    gearbox.\r\n\r\n4.  On the displayed menu, click [[OAuth\r\n    Providers]].\r\n\r\n5.  Click [[Edit]].\r\n\r\n6.  Choose the OAuth service created above. Then\r\n    click [[Save]].\r\n    Click on the back arrow to go back to Manage.\r\n\r\n    ![](images/tutorial_html_6fa9961893476e8e.png)\r\n\r\n## Create a New Version of the Inventory API\r\n\r\nAPI Connect supports multiple versions of APIs. Create a new version of\r\nthe inventory API before making any changes that would break\r\nfunctionality for existing consumers. \r\n\r\n### [Save as a New Version]\r\n\r\n1.  In the API Manager from the main menu on the left,\r\n    click [[Develop]].\r\n\r\n2.  Click on the menu icon to the right of [[inventory\r\n    1.0.0]] API\r\n    and select [[Save as a new\r\n    version]].  \r\n\r\n    ![](images/tutorial_html_4f0d083547b597a4.png)\r\n\r\n3.  Enter the new version number\r\n    as [[2.0.0]] and\r\n    click [[Submit]].\r\n\r\n## Add OAuth security to the Inventory API\r\n\r\nModify the security policy for your new API version to tell it to use\r\nyour OAuth 2.0 provider.\r\n\r\n1.  From the Develop home page, click \\`**Inventory 2.0.0**\\`\r\n\r\n2.  Navigate to the **[Security\r\n    Definitions]** section.\r\n\r\n3.  Click [[Add]].\r\n\r\n4.  On the API Security Definition screen, enter the following:\r\n\r\n    -   Name: **[oauth-1]**\r\n\r\n    -   Description: [[API OAuth security\r\n        definition]]\r\n\r\n    -   Type: [[OAuth2]]\r\n\r\n    -   Flow: [[Resource owner]]\r\n\r\n    -   Token URL: keep\r\n        default [[https://\\$(catalog.url)/oauth/oauth2/token]]\r\n\r\n    -   Leave everything else to the default values and\r\n        click **Save**.  \r\n\r\n        ![](images/tutorial_html_9b9f57dc81561ae7.png)\r\n\r\n5.  Navigate to the \\`Security\\` section and check the \\`**oauth-1\r\n    (OAuth)**\\` checkbox. Make sure \\`inventory\\` is also checked.  \r\n\r\n    ![](images/tutorial_html_c8a8e86664fd2a1.png)\r\n\r\n6.  Save your changes.\r\n\r\n## Summary\r\n\r\nYou completed the APIC Dev Jam Lab 3 - Add OAuth Security to your\r\nAPI. Throughout the tutorial, you explored the key takeaways:\r\n\r\n-   Configure an OAuth 2.0 service, the Resource Owner Password grant\r\n    type.\r\n\r\n-   Clone a new version of an API.\r\n\r\n-   Secure the new version of your API.\r\n\r\nContinue the APIC Dev Jam! Go To [APIC (v10) Dev Jam Lab 4 - Use\r\nLifecycle controls to version your\r\nAPI](../Lab4) to\r\nmanage the lifecycle of this API and test your new OAuth secured API.\r\n","fileAbsolutePath":"C:/Users/ruffa/Documents/GitHub/cp4i-demohub/src/pages/APICDevJam/Lab3/index.md"}}},"staticQueryHashes":["1054721580","1054721580","1364590287","2102389209","2102389209","2456312558","2746626797","2746626797","3018647132","3018647132","3037994772","3037994772","768070550","768070550"]}